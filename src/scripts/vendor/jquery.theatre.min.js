/*
 *  jquery-theatre - v1.0.0
 *  An immersive image viewer for jQuery.
 *  http://bitbucket.org/st-andrews/jquery-theatre
 *
 *  Made by Sam Parsons
 *  Under MIT License
 */
!function(a,b){"use strict";function c(b,c){this.element=b,this.settings=a.extend({},e,c),this._defaults=e,this._name=d,this.init()}var d="theatre",e={},f="<div id='theatre__stage'><div id='theatre__wrap'><div id='theatre__prev'><a></a></div><figure id='theatre__figure'><img><figcaption></figcaption></figure><div id='theatre__next'><a></a></div></div><div id='theatre__close'><i></i></div><div id='theatre__counter'></div></div>",g="#theatre__stage",h="#theatre__counter",i="theatre---";a.extend(c.prototype,{init:function(){var c,d=this,e=a(this.element);d.initStage(),c=d.addImageToLineup(d.element,d.settings),e.click(function(){return d.open(c),!1}).css("cursor","pointer"),i+e.attr("id")===b.location.hash&&d.open(c)},initStage:function(){var b,c,d=this;return 0!==a(g).length?!1:(b=a(f).hide().appendTo("body"),b.data("lineup",[]),c=new Hammer(b[0]),c.get("swipe").set({direction:Hammer.DIRECTION_ALL}),a("#theatre__close").click(function(){return d.close(d)}),a("#theatre__next a").click(function(){return d.next(d)}),a("#theatre__prev a").click(function(){return d.prev(d)}),a(document).keydown(function(a){switch(a.which){case 27:d.close(d);break;case 39:d.next(d);break;case 37:d.prev(d)}}),c.on("swipeup",function(){d.close(d)}),c.on("swipeleft",function(){d.next(d)}),void c.on("swiperight",function(){d.prev(d)}))},addImageToLineup:function(b){var c=a(g),d=c.data("lineup");return d.push(b),a.data(c,"lineup",d),d.length-1},open:function(c){var d,e,f,j,k=a(g),l=k.data("lineup");return d=a(l[c]),e=0!==d.find("img").parent("a").length?d.find("img").parent("a").attr("href"):d.find("img").attr("src"),f=d.find("figcaption").text(),j=String(c+1)+"/"+String(l.length),k.find("img").attr("src",e),k.find("figcaption").text(f),a(h).text(j),d.attr("id")?b.location.hash=i+d.attr("id"):b.location.hash="",k.data("currentIndex",c),k.show(),!1},next:function(b){var c=a(g),d=c.data("lineup"),e=c.data("currentIndex"),f=(e+1)%d.length;return c.is(":visible")&&b.open(f),!1},prev:function(b){var c=a(g),d=c.data("lineup"),e=c.data("currentIndex"),f=0===e?d.length-1:e-1;return c.is(":visible")&&b.open(f),!1},close:function(){var c=a(g);return c.is(":visible")&&c.hide(),b.location.hash.indexOf(i)&&(b.location.hash=""),!1}}),a.fn[d]=function(b){return this.each(function(){a.data(this,"plugin_"+d)||a.data(this,"plugin_"+d,new c(this,b))})}}(jQuery,window);